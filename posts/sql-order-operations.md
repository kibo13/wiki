## Порядок выполнения SQL-операций

**План выполнения запроса** - последовательность операций, необходимых для получения результата SQL-запроса.

Порядок выполнения запроса: 

1. FROM + JOIN 
2. WHERE 
3. GROUP BY 
4. HAVING 
5. SELECT 
6. ORDER BY 
7. LIMIT и OFFSET 

### FROM + JOIN

Логическое выполнение запроса начинается с инструкции **FROM**, которая собирает данные из таблиц, упомянутых в запросе. 

### WHERE

Следующим шагом является предложение **WHERE**, которое фильтрует данные в соответствии с определяемыми пользователем условиями. 

Эти условия могут включать ссылки на данные и таблицы из условия **FROM**, но не могут включать ссылки на псевдонимы, 
определенные в **SELECT**

> В **WHERE** нельзя писать условия по агрегатным функциям (**SUM**, **COUNT**, **MAX**, **MIN** и другие), 
> для этого существует **HAVING**.

### GROUP BY 

Предложение **GROUP BY** выполняет группировку записей (данных), полученных из условия (условий) **WHERE**

### HAVING

Тут происходит фильтрация групп на основе заданных условий, созданных в **GROUP BY**. 

> В **HAVING** можно писать условия по агрегатным функциям (**SUM**, **COUNT**, **MAX**, **MIN** и другие)

Поскольку данные уже сгруппированы, доступ к исходным строкам на этом этапе не возможен, 
поэтому условие можно применить только для фильтрации целых сегментов, а не отдельных строк в сегменте. 

Кроме того, псевдонимы, определенные в **SELECT**, также не доступны на этом шаге.

### SELECT

Инструкция **SELECT** определяет данные, которые будут отправлены на результат. 
В качетве данных можно использовать имена столбцов, агрегаты, подзапросы внутри предложения **SELECT**, а также 
ключевые слова, такие как **UNIQUE**, **DISTINCT** и **TOP**, если они включены.

### ORDER BY

Инструкция **ORDER BY** используется для сортировки данных по указанному в нем имени столбца.
Сортировку данных можно выбрать по убыванию (**DESC**) или по возрастанию (**ASC**).
По умолчанию данные сортируются в порядке возрастания (**ASC**).

Также **ORDER BY** может быть уникальным для каждого поля:

```sql
ORDER BY first_name ASC, age DESC
```

### LIMIT и OFFSET 

Иногда возникает необходимость отбросить все строки, кроме первых N-строк результата запроса.
Инструкция **LIMIT**, которое выполняется после сортировки, позволяет задать ограничение на количество выводимых записей. 
Кроме того, можно выбрать, с какой строки начать извлечение данных и сколько необходимо исключить, используя комбинацию 
ключевых слов **LIMIT** и **OFFSET**.

В следующем примере будет выбрано 50 строк, начиная с строки 100: 

```sql
LIMIT 50 OFFSET 100
```